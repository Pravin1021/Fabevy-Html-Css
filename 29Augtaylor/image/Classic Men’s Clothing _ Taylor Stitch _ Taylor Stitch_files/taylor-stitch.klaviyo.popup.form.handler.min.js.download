"use strict";var TSKlaviyoPopupFormHandler=function(){function e(e){this.opts=e,this.logPrefix="TSKlaviyoPopupFormHandler",this.PopupTrackingData={Category:"UserSignupKlaviyoFlyout",Actions:{EmailSubscribed:"EmailSubscribed",PhoneSubscribed:"PhoneSubscribed"}}}return e.prototype.init=function(){this.registerEvents()},e.prototype.showModal=function(){try{window._klOnsite=window._klOnsite||[],window._klOnsite.push(["openForm","TrkzaF"])}catch(e){console.error("".concat(this.logPrefix),e)}},e.prototype.trackKlaviyoEventIfNeeded=function(){var e;if(null!=(e=this.opts)&&e.trackingEventName)try{(window._learnq||[]).push(["track",this.opts.trackingEventName])}catch(e){console.error("".concat(this.logPrefix),e)}},e.prototype.onSubscribed=function(e){e&&(e.$email&&(T3Core.TrackUserSignUp(this.PopupTrackingData.Category,this.PopupTrackingData.Actions.EmailSubscribed,e.$step_name),T3Core.TrackFacebookCompleteRegistration({currency:TSGlobals.currency,value:0,content_name:this.PopupTrackingData.Category}),TSRedditPixelManager.trackSignup(),T3Core.Debug("".concat(this.logPrefix," email subscribed")),this.trackKlaviyoEventIfNeeded()),e.$phone_number&&(T3Core.TrackUserSignUp(this.PopupTrackingData.Category,this.PopupTrackingData.Actions.PhoneSubscribed,e.$step_name),T3Core.Debug("".concat(this.logPrefix," phone subscribed"))))},e.prototype.registerEvents=function(){var o=this;$(".popupTrigger").on("click",function(e){e.preventDefault(),o.showModal()}),window.addEventListener("klaviyoForms",function(e){var e=e.detail,t=e.metaData;switch(e.type){case"open":case"submit":case"close":break;case"stepSubmit":T3Core.Debug("".concat(o.logPrefix," stepSubmitted")),o.onSubscribed(t)}})},e}();